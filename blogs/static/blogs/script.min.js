$(document).ready((function(){function refresh_comments(post_id){$.ajax({type:"GET",url:"/refresh_comments/",data:{post_id:post_id},success:function(data){no_of_comments=data.no_of_comments,0==no_of_comments?$(".comments").text("No comments yet."):1==no_of_comments?$(".comments").text(no_of_comments+" Comment"):$(".comments").text(no_of_comments+" Comments")}})}window.setTimeout((function(){$(".alert").fadeTo(500,0).slideUp(500,(function(){$(this).hide()}))}),5e3),$(".follow-btn").on("click",(function(){username=$(".username_field").text();var current_obj=$(this);$.ajax({type:"POST",url:"/follow/",data:{username:username},success:function(data){"success"==data.status&&location.reload()}})})),$(".following-btn").on("click",(function(){username=$(".username_field").text(),$.ajax({type:"POST",url:"/unfollow/",data:{username:username},success:function(data){"success"==data.status&&location.reload()}})})),$(document).on("click",".vote_up",(function(){post_id=$(this).closest("article").attr("id"),likes=$("#"+post_id).find("#votes_count").text(),$.ajax({type:"POST",url:"/vote_up/",cache:!1,data:{post_id:post_id},success:function(data){"success"==data.status?(likes++,$("#"+post_id).find("#votes_count").text(likes),$("#upvote_"+post_id).css("color","#8bf178"),$("#downvote_"+post_id).css("color","")):"Invalid"==data.status&&alert("You cannot vote on your own post!")}})})),$(document).on("click",".vote_down",(function(){post_id=$(this).closest("article").attr("id"),likes=$("#"+post_id).find("#votes_count").text(),$.ajax({type:"POST",url:"/vote_down/",cache:!1,data:{post_id:post_id},success:function(data){"success"==data.status?(likes--,$("#"+post_id).find("#votes_count").text(likes),$("#downvote_"+post_id).css("color","red"),$("#upvote_"+post_id).css("color","")):"Invalid"==data.status&&alert("You cannot vote on your own post.")}})})),$(document).on("click",".delete_comment",(function(){var result;confirm("Are you sure you want to delete your comment?")&&(comment_id=$(this).closest("li").attr("id"),post_id=$("article").attr("id"),$.ajax({type:"POST",url:"/delete_comment/",cache:!1,data:{comment_id:comment_id},success:function(){$("#"+comment_id).hide(),refresh_comments(post_id)}}))})),$((function(){var comment;$(document).on("click",".edit_comment",(function(){comment_id=$(this).closest("li").attr("id"),comment=$("#"+comment_id).find("p").text().trim(),$(".edit_delete").hide(),$("#"+comment_id).find(".comment_p").html("<textarea class='form-control mb-2 comment_edit_text'>"+comment+"</textarea><a href='#' class='save_edit_btn mr-3'>Save</a><a href='#' class='cancel_edit_btn'>Cancel</a>")})),$(document).on("click",".cancel_edit_btn",(function(){comment_id=$(this).closest("li").attr("id"),$(".edit_delete").show(),$("#"+comment_id).find(".comment_p").html('<p class="comment_text">'+comment+"</p>")}))})),$(document).on("click",".save_edit_btn",(function(){comment_id=$(this).closest("li").attr("id"),edit_comment=$(".comment_edit_text").val(),$.ajax({type:"POST",url:"/edit_comment/",cache:!1,data:{comment_id:comment_id,edit_comment:edit_comment},success:function(){$(".edit_delete").show(),$("#"+comment_id).find(".comment_p").html('<p class="comment_text">'+edit_comment+"</p>")}})})),$(document).on("click",".notification-list",(function(){n_id=$(this).attr("id"),$.ajax({type:"POST",url:"/mark_notification_as_read/",cache:!1,data:{n_post_id:n_id},success:function(){}})})),$("#noti_Button").click((function(){return $("#notifications").fadeToggle("fast","linear",(function(){$("#notifications").is(":hidden")})),$("#noti_counter").fadeOut("slow"),!1})),$(document).click((function(){$("#notifications").hide()})),$(".index_blog_full_description img").click((function(){$("#full-image").attr("src",$(this).attr("src")),$("#image-viewer").show()})),$(".blog_image").click((function(){$("#full-image").attr("src",$(this).attr("src")),$("#image-viewer").show()})),$("#image-viewer").on("click",(function(){$("#image-viewer").hide()})),$("#image-viewer .close").click((function(){$("#image-viewer").hide()})),$("#txtSearch").keyup((function(){var val=$(this).val();$.ajax({type:"GET",data:{uname:val},url:"/searchUser/",success:function(data){if(data.results.length>0)for(var key in $("#searchResults").empty(),data)for(var val in data[key]){var htm='<img class="rounded-circle round_profile_pics mr-2" src="'+data[key][val].profile_pic+'"></img>';$("#searchResults").append(htm+"<a href='/profile/"+data[key][val].user+"'><h6>"+data[key][val].user+"</h6></a></li>")}}})}))}));